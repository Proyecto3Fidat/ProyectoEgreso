<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../Public/css/calificacionIn.css">
    <link rel="stylesheet" href="../../Public/css/responsive.css">
    <script src="https://kit.fontawesome.com/58f9dcf30d.js" crossorigin="anonymous"></script>
    <title>Calificar</title>

    <style>
        .content {
            display: none;
        }
    </style>
</head>
<header>
    <section class="navhead">
        <button class="abrirmenu" id="abrir"><i class="fa-solid fa-bars fa-xl" style="color: #ffffff;"></i></button>
    </section>
    <nav class="navbar" id="nav">
        <button class="cerrarmenu" id="cerrar"><i class="fa-solid fa-right-from-bracket fa-xl"style="color: #ffffff;"></i></button>
        <div class="menu1">
            <ul class="listmenu1">
                <li><a href="/" class="inicioa">Inicio</a></li>
                <li><a href="/horarios" class="inicioa">Horarios</a></li>
                <li><a href="/planes" class="inicioa">Planes</a></li>
                <li><a href="/">Nosotros</a></li>
            </ul>
        </div>
        <div class="menu2">
            <ul class="listmenu2" id="welcome-message">
            </ul>
        </div>
    </nav>
</header>
<body>
<div class="content">
    <h4>Calificar</h4>
    <form action="/calificacion" method="post" class="califidepo">
        <input type="text" id="documento" name="nroDocumento" placeholder="Documento" required>
        <input name="puntMaxima" type="text" placeholder="Puntuacion maxima">
        <input name="puntuacionEsperado" type="text" placeholder="Calificacion Esperada">
        <input name="fuerzaMusc" type="text" placeholder="Fuerza Muscular">
        <input name="resAnaerobica" type="text" placeholder="Resistencia anaerobica">
        <input name="resiliencia" type="text" placeholder="Resiliencia">
        <input name="flexibilidad" type="text" placeholder="Flexibilidad">
        <input name="resMusc" type="text" placeholder="Resistencia muscular">
        <input name="cumplAgenda" type="text" placeholder="Cumplimiento de agenda">
        <input name="resMonotonia" type="text" placeholder="Resistencia a la monotonia">
        <input type="submit">
    </form>
</div>

<footer class="footer">
    <h1>Gracias por elegirnos!</h1>
    <h2>Nuestras Redes</h2>

</footer>
<script>
    document.addEventListener('DOMContentLoaded', function () {

        const urlParams = new URLSearchParams(window.location.search);
        const documento = urlParams.get('documento');

        if (documento) {
            document.getElementById('documento').value = documento;
        }
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Verificar autenticación al cargar la página
        fetch('/verificarsesion', {
            method: 'GET'
        })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    // Si hay un error de autenticación, redirigir al login
                    alert(data.error);
                    window.location.href = '/login';
                } else {
                    // Mostrar el formulario si está autenticado
                    document.getElementById('formulario-crear-ejercicio').classList.remove('oculto');
                }
            })
            .catch(error => {
                alert('Error al verificar la sesión. Intente nuevamente.');
                console.error('Error:', error);
                window.location.href = '/login';
            });

        // Manejar el envío del formulario de calificación
        document.querySelector('form.califidepo').addEventListener('submit', function (event) {
            event.preventDefault();

            const formData = new FormData(this);
            fetch('/calificacion', {
                method: 'POST',
                body: formData,
            })
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        alert(data.error);
                    } else {
                        alert('Calificación creada con éxito');
                        window.location.href = '/listaUsuarios';
                    }
                })
                .catch(error => {
                    alert('Hubo un problema con la solicitud. Intenta nuevamente.');
                    console.error('Error:', error);
                });
        });

        // Mostrar el formulario cuando se hace clic en un botón (opcional)
        document.getElementById('abrir').addEventListener('click', function () {
            const formulario = document.getElementById('formulario-crear-ejercicio');
            formulario.classList.toggle('oculto');
        });
    });
</script>


<script src="../../Public/js/script.js"></script>
<script src="../../Public/js/responsive.js"></script>
</body>
</html>

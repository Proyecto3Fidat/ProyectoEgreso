<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../../Public/css/responsive.css">
    <script src="https://kit.fontawesome.com/58f9dcf30d.js" crossorigin="anonymous"></script>
    <title>Dashboard del Usuario</title>
    <style>
        /* Estilos para el modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #1e1c1f;
            padding: 40px;
            border-radius: 15px;
            border: 5px solid #7a3afa;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.5);
            width: 80%;
            height: 80%;
            max-width: 600px;
            position: relative;
            animation: fadeIn 0.3s ease-out;
        }

        /* Efecto de entrada suave */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-content iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .close-button {
            position: absolute;
            top: 10px;
            right: 15px;
            width: 3em;
            height: 3em;
            border: none;
            background: rgba(255, 0, 0, 0.1);
            border-radius: 50%;
            cursor: pointer;
            transition: background 0.5s, box-shadow 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        /* Líneas de la "X" */
        .X, .Y {
            position: absolute;
            width: 1.5em;
            height: 2px;
            background-color: #ffffff;
            transition: transform 0.3s ease, background-color 0.3s ease;
        }

        .X {
            transform: rotate(45deg);
        }

        .Y {
            transform: rotate(-45deg);
        }

        /* Texto de "Close" emergente */
        .close-button .close {
            position: absolute;
            display: flex;
            padding: 0.8rem 1.5rem;
            align-items: center;
            justify-content: center;
            transform: translateX(-50%);
            top: -80%;
            left: 50%;
            width: 4em;
            height: 2em;
            font-size: 12px;
            background-color: rgb(19, 22, 24);
            color: rgb(187, 229, 236);
            border: none;
            border-radius: 3px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .close-button:hover {
            background-color: rgba(239, 9, 9, 0.2);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .close-button:active {
            background-color: rgb(236, 11, 11);
        }

        .close-button:hover > .close {
            opacity: 1;
        }

        .close-button:hover > .X,
        .close-button:hover > .Y {
            background-color: #ffcccc;
        }
    </style>
</head>
<body>
<div class="dashboardContainer">
    <script src="../../Public/js/listaCalificaciones.js"></script>

    <h1>Bienvenido al Dashboard del Usuario {{ usuario.nombre }} {{ usuario.apellido }}</h1>

    <!-- Seccion de Informacion del Usuario -->
    <section class="informacionUsuario">
        <h2>Información del Usuario</h2>
        <div class="usuarioInfo">
            <p><strong>Nombre:</strong> {{ usuario.nombre }}</p>
            <p><strong>Edad:</strong> {{ usuario.edad }}</p>
            <p><strong>Altura:</strong> {{ usuario.altura }}</p>
            <p><strong>Peso:</strong> {{ usuario.peso }}</p>
            <p><strong>Documento:</strong> {{ usuario.documento }}</p>
        </div>
    </section>

    <section class="calificaciones">
        <h2>Calificaciones</h2>
        <div class="tablaCliente">
            <table class="clasCliente" id="tablaCalificaciones">
                <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Puntuación Total</th>
                    <th>Fuerza Muscular</th>
                    <th>Resistencia Muscular</th>
                    <th>Flexibilidad</th>
                    <th>Imprimir</th>
                </tr>
                </thead>
                <tbody>
                {% for calificacion in calificaciones %}
                    <tr>
                        <td>{{ calificacion.fecha }}</td>
                        <td>{{ calificacion.puntObtenido }}</td>
                        <td>{{ calificacion.fuerzaMusc }}</td>
                        <td>{{ calificacion.resMusc }}</td>
                        <td>{{ calificacion.flexibilidad }}</td>
                        <td>
                            <button onclick="/imprimirCalificacion?id=({{ calificacion.id }})">
                                <i class="fas fa-print"></i> Imprimir
                            </button>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="6">No hay calificaciones disponibles</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </section>

    <section class="rutina">
        <h2>Rutina</h2>
        <button onclick="openModal()">Asignar Rutina</button>
        <div class="tablaRutina">
            <table class="clasRutina" id="tablaRutina">
                <tr>
                    <th>Día</th>
                    <th>Ejercicio</th>
                    <th>Series</th>
                    <th>Repeticiones</th>
                    <th>Descanso</th>
                </tr>
                <tr>
                    <td>Lunes</td>
                    <td>Press de Banca</td>
                    <td>4</td>
                    <td>12</td>
                    <td>90 seg</td>
                </tr>
            </table>
        </div>
    </section>

    <section class="evolucion">
        <h2>Evolución</h2>
        <div class="graficaEvolucion">
            <p>Aquí podrás ver tu evolución física a lo largo del tiempo.</p>
            <img src="/../../Resources/Images/Graphics/grafico_evolucion_{{ usuario.documento }}.png" alt="Gráfica de Evolución">
        </div>
    </section>
</div>

<!-- Modal para Asignar Rutina -->
<div class="modal" id="modalRutina">
    <div class="modal-content">
        <button class="close-button" onclick="closeModal()">
            <span class="X"></span>
            <span class="Y"></span>
            <div class="close">Close</div>
        </button>
        <iframe src="/asignarRutina?id={{ usuario.id }}"></iframe>
    </div>
</div>

<script>
    function openModal() {
        document.getElementById('modalRutina').style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('modalRutina').style.display = 'none';
    }

    // Cierra el modal al hacer clic fuera del contenido
    window.onclick = function(event) {
        const modal = document.getElementById('modalRutina');
        if (event.target === modal) {
            closeModal();
        }
    }
</script>

</body>
</html>
